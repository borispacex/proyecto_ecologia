<div class="container-fluid">
    <div class="block-header">
        <div class="row">
            <div class="col-lg-5 col-md-8 col-sm-12">
                <h2>
                    <a type="button" class="btn btn-xs btn-link btn-toggle-fullwidth text-primary" (click)="toggleFullWidth()">
						<i class="fa fa-arrow-left" *ngIf="sidebarVisible"></i>
						<i class="fa fa-arrow-right" *ngIf="!sidebarVisible"></i>
					</a>
                    Avances proyecto
                </h2>
                <ul class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a [routerLink]="['../../']"><i class="icon-home"></i></a>
                    </li>
                    <li class="breadcrumb-item">Dashboard</li>
                    <li class="breadcrumb-item">
                        <a [routerLink]="['../../list-proyectos-inv','proyecto']">Lista proyectos investigador</a>
                    </li>
                    <li class="breadcrumb-item active">{{ id }}</li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row clearfix">
        <div class="col-lg-8 col-md-8">
            <div class="card">
                <div class="body">
                    <div class="details">
                        <h3 class="product-title m-b-0"><strong>{{proyecto.titulo}}</strong></h3>
                        <hr>
                        <h5 class="price m-t-0"><strong>Inicio de proyecto: </strong> <span class="text-primary">{{proyecto.fechaini | date: 'dd/MM/yyyy'}}</span></h5>
                        <h5 class="price m-t-0"><strong>Fin de proyecto: </strong> <span class="text-primary">{{proyecto.fechafin | date: 'dd/MM/yyyy'}}</span></h5>
                        <h5 class="sizes"><strong>Investigador coordinador: </strong>
                            <ul>
                                <li>
                                    <a [routerLink]="['../../../profiles/inv-profile/', proyecto.investigadore.persona.id_persona]" class="text-primary">{{proyecto.investigadore.persona.nombres}} {{proyecto.investigadore.persona.paterno}} {{proyecto.investigadore.persona.materno}}</a>
                                </li>
                            </ul>
                        </h5>
                        <section *ngIf="proyecto.investigadores">
                            <h5 class="colors"><strong>Investigadores: </strong>
                                <ul>
                                    <li *ngFor="let inv of proyecto.investigadores">
                                        <a [routerLink]="['../../../profiles/inv-profile/', inv.investigadore.persona.id_persona]" class="text-primary">{{inv.investigadore.persona.nombres}} {{inv.investigadore.persona.paterno}} {{inv.investigadore.persona.materno}}</a>
                                    </li>
                                </ul>
                            </h5>
                        </section>
                        
                        <section *ngIf="proyecto.carrera || proyecto.n_instituto || proyecto.n_instituto || proyecto.objetivo || proyecto.resumen">
                            <hr>
                            <p class="align-center">Basica general</p>
                            <h5 class="price m-t-0" *ngIf="proyecto.carrera"><strong>Carrera: </strong> <span class="text-primary">{{proyecto.carrera}}</span></h5>
                            <h5 class="price m-t-0" *ngIf="proyecto.n_instituto"><strong>Nombre del Instituto: </strong> <span class="text-primary">{{proyecto.n_instituto}}</span></h5>
                            <h5 class="price m-t-0" *ngIf="proyecto.objetivo"><strong>Objetivo: </strong> <span class="text-primary">{{proyecto.objetivo | slice:0:300}}</span></h5>
                            <h5 class="price m-t-0" *ngIf="proyecto.resumen"><strong>Resumen: </strong> <span class="text-primary">{{proyecto.resumen | slice:0:400}}</span></h5>
                        </section>
                        
                        <section *ngIf="proyecto.tipo || proyecto.area || proyecto.tipo_p || proyecto.carga_h">
                            <hr>
                            <p class="align-center">Basica tecnica</p>
                            <h5 class="price m-t-0" *ngIf="proyecto.tipo"><strong>Tipo de investigación: </strong> <span class="text-primary">{{proyecto.tipo}}</span></h5>
                            <h5 class="price m-t-0" *ngIf="proyecto.area"><strong>Linea o Area de investigación: </strong> <span class="text-primary">{{proyecto.area}}</span></h5>
                            <h5 class="price m-t-0" *ngIf="proyecto.tipo_p"><strong>Tipo de proyecto: </strong> <span class="text-primary">{{proyecto.tipo_p}}</span></h5>
                            <h5 class="price m-t-0" *ngIf="proyecto.carga_h"><strong>Carga horaria dedicada al proyecto: </strong> <span class="text-primary">{{proyecto.carga_h}}</span></h5>
                        </section>
                        
                        <section *ngIf="proyecto.unidades">
                            <hr>
                            <h5 class="colors"><strong>Unidades: </strong>
                                <ul>
                                    <li *ngFor="let uni of proyecto.unidades">
                                        <a type="button">
                                            <span class="text-primary">{{uni.nombre}}</span> &nbsp;
                                            <span class="text-info">{{uni.observacion}}</span> &nbsp;
                                        </a>
                                    </li>
                                </ul>
                            </h5>
                        </section>
                        <section *ngIf="proyecto.financiamientos">
                            <hr>
                            <h5 class="price m-t-0" *ngIf="proyecto.financiamiento"><strong>Financiamiento: </strong> <span class="text-primary">{{proyecto.financiamiento}} {{proyecto.moneda}}</span></h5>
                            <h5 class="colors"><strong>FInanciamientos: </strong>
                                <ul>
                                    <li *ngFor="let fina of proyecto.financiamientos">
                                        <a type="button">
                                            <span class="text-primary">{{fina.fuente}}</span> &nbsp;
                                            <span class="text-success">{{fina.aporte}} {{proyecto.moneda}}</span> &nbsp;
                                            <span class="text-info">{{fina.observacion}}</span>
                                        </a>
                                    </li>
                                </ul>
                            </h5>
                        </section>
                        <div class="action">
                            <p>
                                <ngb-progressbar [showValue]="true" type="warning" [value]="proyecto.proceso" [max]="100">
                                </ngb-progressbar>
                            </p>
                            <div class="row">
                                <div class="col-7">
                                    <!-- <small>Numero de archivos: 23</small> -->
                                    <h5>
                                        <strong>estado: </strong>
                                        <span *ngIf="proyecto.estado==='activo'" class="badge badge-success">Activo</span>
                                        <span *ngIf="proyecto.estado==='inactivo'" class="badge badge-default">Inactivo</span>
                                        <span *ngIf="proyecto.estado==='pendiente'" class="badge badge-warning">Pendiente</span>
                                        <span *ngIf="proyecto.estado==='cerrado'" class="badge badge-primary">Cerrado</span>
                                    </h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-6">
            <button type="button" class="btn btn-default mr-1 mb-3 card align-items-center" (click)="openModalNuevaPublicacion(content4, 'lg')">
                <i class="icon-bag"></i> &nbsp;<span class="h6">Realizar publicación</span>
            </button>

            <button type="button" class="btn btn-default mr-1 mb-3 card align-items-center" (click)="openModalBaseTecnica(content1,'lg')">
                <i class="icon-info"></i> &nbsp;<span class="h6">Basica tecnica</span>
            </button>
            <button type="button" class="btn btn-default mr-1 mb-3 card align-items-center" (click)="openModalLugarDesarrollo(content2, 'lg')">
                <i class="icon-pointer"></i> &nbsp;<span class="h6">Lugar de desarrollo</span>
            </button>
            <div ngbDropdown>
                <button class="btn btn-default mr-1 mb-3 card align-items-center" id="dropdownBasic1" ngbDropdownToggle>
                    <i class="icon-book-open"></i> &nbsp;<span class="h6">Difusión</span></button>
                <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                    <button class="btn btn-default" (click)="openModalDifusion(content3, 'lg', 1)" ngbDropdownItem>Cursos, Seminarios y Talleres</button>
                    <button class="btn btn-default" (click)="openModalDifusion(content3, 'lg', 2)" ngbDropdownItem>Eventos cientificos</button>
                    <button class="btn btn-default" (click)="openModalDifusion(content3, 'lg', 3)" ngbDropdownItem>Notas de prensa</button>
                    <button class="btn btn-default" (click)="openModalDifusion(content3, 'lg', 4)" ngbDropdownItem>Exposiciones y conferencias</button>
                </div>
            </div>
            <!-- <button type="button" class="btn btn-default mr-1 mb-3 card align-items-center" href="javascript:void(0)">
                <i class="fa fa-flag"></i>&nbsp;<span class="h6"> Solicitud de cierre de proyecto</span>
            </button> -->
        </div>
    </div>



    <div class="row ">
        <div class="sidebar-scroll col-lg-12">
            <!-- Nav tabs -->
            <ul class="nav nav-tabs-new">
                <li class="nav-item"><a class="nav-link" data-toggle="tab" [routerLink]="['../',id]" fragment="tavArchivos" [ngClass]="{'active':fragment == 'tavArchivos'}">Archivos</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" [routerLink]="['../',id]"fragment="tavPublicaciones" [ngClass]="{'active':fragment == 'tavPublicaciones'}">Publicaciones</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" [routerLink]="['../',id]" fragment="tavLugar" [ngClass]="{'active':fragment == 'tavLugar'}">Lugar de desarrollo</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" [routerLink]="['../',id]" fragment="tavDifusion" [ngClass]="{'active':fragment == 'tavDifusion'}">Difusion</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" [routerLink]="['../',id]" fragment="tavSeguimiento" [ngClass]="{'active':fragment == 'tavSeguimiento'}">Seguimiento</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" [routerLink]="['../',id]" fragment="tavPeticion" [ngClass]="{'active':fragment == 'tavPeticion'}">Petición</a></li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content p-l-0 p-r-0">
                <div class="tab-pane p-l-15 p-r-15" [ngClass]="{'active':fragment == 'tavArchivos'}">
                    
                    <div>
                        <h3 class="align-center"><strong>Lista de archivos</strong></h3>
                    </div>

                    <div class="row">
                        <div class="col-lg-5 col-md-8 col-sm-12">
                            <form id="navbar-search" class="navbar-form search-form">
                                <input [formControl]="search" class="form-control" placeholder="Buscar documento ..."
                                    type="text" />
                                <button type="button" class="btn btn-default"><i class="icon-magnifier"></i></button>
                            </form>
                        </div>
                        <div ngbDropdown class="d-inline-block col-lg-5 col-md-8 col-sm-12" placement="bottom-left">
                            <button class="btn btn-default mr-1 mb-3" id="dropdownBasic1"
                                ngbDropdownToggle>Listado</button>
                            <div ngbDropdownMenu aria-labelledby="dropdownBasic1" right>
                                <button class="btn btn-default" (click)="getArchivosByTipo(8)" ngbDropdownItem>Todos</button>
                                <button class="btn btn-default" (click)="getArchivosByTipo(0)" ngbDropdownItem>Documentos Principales</button>
                                <button class="btn btn-default" (click)="getArchivosByTipo(1)" ngbDropdownItem>Permisos</button>
                                <button class="btn btn-default" (click)="getArchivosByTipo(2)" ngbDropdownItem>Suscripción Convenios</button>
                                <button class="btn btn-default" (click)="getArchivosByTipo(3)" ngbDropdownItem>Personal Contratado</button>
                                <button class="btn btn-default" (click)="getArchivosByTipo(6)" ngbDropdownItem>Proyecto final</button>
                                <button class="btn btn-default" (click)="getArchivosByTipo(7)" ngbDropdownItem>Otros</button>
                            </div>
                        </div>
                    </div>

                    <!-- <div class="row file_manager"> -->
                    <div class="row file_manager" *ngIf="(archivos | searchArchivos: valorBusqueda) as result">
                        <div class="card" *ngIf="result.length === 0 || archivos.length === 0">
                            <div class="body text-center">
                                <div class="not_found">
                                        <h4 class="m-b-0">Lo sentimos, No se encontraron resultados.</h4>
                                </div>
                            </div>
                        </div>

                        <div class="card product_item_list" *ngIf="result.length > 0">
                            <div class="body">
                                <h5 class="text-center text-lg-left"><strong>{{tituloArch}}</strong></h5>
                                <div class="table-responsive">
                                    <table class="table table-hover m-b-0">
                                        <thead class="thead-dark align-center">
                                            <tr>
                                                <th>Nombre archivo</th>
                                                <th data-breakpoints="sm xs">Descripcion</th>
                                                <th data-breakpoints="xs">Tipo</th>
                                                <th>Archicos extras</th>
                                                <th data-breakpoints="md">Ultima modificación</th>
                                                <th data-breakpoints="xs md">Estado</th>
                                            </tr>
                                        </thead>
                                        <tbody *ngFor="let archivo of result">
                                            <tr>
                                                <td>
                                                    <a *ngIf="archivo.id_proy_archivo" type="button" target="_blank" href="{{who + 'proyectos/' + archivo.archivo}}"><i class="fa fa-file text-success"></i></a>
                                                    <a *ngIf="archivo.id_permiso_archivo" type="button" target="_blank" href="{{who + 'permisos/' + archivo.archivo}}"><i class="fa fa-file text-success"></i></a>
                                                    <a *ngIf="archivo.id_convenio" type="button" target="_blank" href="{{who + 'convenios/' + archivo.archivo}}"><i class="fa fa-file text-success"></i></a>
                                                    <a *ngIf="archivo.id_contratado" type="button" target="_blank" href="{{who + 'contratados/' + archivo.archivo}}"><i class="fa fa-file text-success"></i></a>
                                                    &nbsp;
                                                    <span class="title"><a type="button" class="text-success" (click)="openModalArchivo(content5,'lg', archivo)">{{archivo.nombre}}</a></span>
                                                </td>
                                                    
                                                <td>{{ archivo.descripcion }}</td>
                                                <td>{{ tipoArchivo(archivo.id_tipo) }}</td>
                                                <td>
                                                    <small *ngIf="!archivo.convArchivos">Ninguna</small>
                                                    <div *ngFor="let archivoB of archivo.convArchivos">
                                                        <a *ngIf="archivoB.id_conv_archivo" type="button" target="_blank" href="{{who + 'convenios/' +archivoB.archivo}}"><i class="fa fa-file text-info"></i></a>
                                                        <a *ngIf="archivoB.id_contra_archivo" type="button" target="_blank" href="{{who + 'contratados/' +archivoB.archivo}}"><i class="fa fa-file text-info"></i></a>
                                                        &nbsp;
                                                        <small class="title"><a type='button' class="text-primary" (click)="openModalArchivo(content5,'lg', archivoB)">{{archivoB.nombre}}</a></small>
                                                    </div>
                                                </td>
                                                <td>
                                                    {{archivo.createdAt | date: 'dd/MM/yyyy'}}
                                                </td>
                                                <td>
                                                    <span *ngIf="archivo.estado" [ngClass]="{'badge badge-success bg-success text-white': true}">activo</span>
                                                    <span *ngIf="!archivo.estado" [ngClass]="{'badge badge-danger bg-danger text-white': true}">eliminado</span>
                                                </td>
                                                
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>     
                    </div>

                </div>

                <div class="tab-pane p-l-0 p-r-0" [ngClass]="{'active':fragment == 'tavPublicaciones'}">
                    <h3 class="align-center"><strong>Publicaciones</strong></h3>
                    <div class="card" *ngIf="publicaciones.length === 0">
                        <div class="body text-center">
                            <div class="not_found">
                                    <h4 class="m-b-0">Lo sentimos, No se encontraron resultados.</h4>
                            </div>
                        </div>
                    </div>
                    <div class="card product_item_list" *ngIf="publicaciones.length > 0">
                        <div class="body">
                            <div class="table-responsive">
                                <table class="table table-hover m-b-0">
                                    <thead class="thead-dark align-center">
                                        <tr>
                                            <th data-breakpoints="xs">Tipo de publicación</th>
                                            <th>Titulo</th>
                                            <th>Autores</th>
                                            <th data-breakpoints="md">Fecha</th>
                                            <th data-breakpoints="md">Archivos</th>
                                            <th data-breakpoints="xs md">Estado</th>
                                            <th data-breakpoints="sm xs md">Acción</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let publicacion of publicaciones">
                                            <td>{{publicacion.tipo}}</td>
                                            <td>{{publicacion.titulo}}</td>
                                            <td>
                                                <div *ngFor="let autor of publicacion.autores">
                                                    <small>{{autor.investigadore.persona.nombres}} {{autor.investigadore.persona.paterno}} {{autor.investigadore.persona.materno}}</small>
                                                </div>
                                            </td>
                                            <td>{{publicacion.fecha | date }}</td>
                                            <td>
                                                <div *ngFor="let archivoB of publicacion.archivos">
                                                    <a type="button" target="_blank" href="{{who + 'publicaciones/' +archivoB.archivo}}">
                                                        <i class="fa fa-file text-info"></i>
                                                    </a>
                                                    &nbsp;
                                                    <small class="title"><a type="button" class="text-primary" (click)="openModalArchivo(content5, 'lg', archivoB)">{{archivoB.nombre}}</a></small>
                                                    <!-- <small><a (click)="openModalArchivo(content5, 'lg', archivoB)"> {{archivoB.nombre}} </a></small> -->
                                                </div>
                                            </td>
                                            <td>
                                                <span *ngIf="publicacion.estado===true"
                                                    class="badge badge-success bg-success text-white">Activo</span>
                                                <span *ngIf="publicacion.estado===false"
                                                    class="badge badge-danger bg-danger text-white">Inactivo</span>
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-outline-secondary mr-1" (click)="openModalNuevaPublicacion(content4, 'lg', publicacion.id_publicacion)" data-toggle="tooltip" data-placement="right" title="Editar">
                                                    <i class="icon-pencil"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary" (click)="openModalEliminar(content9, 'sm', publicacion)" data-toggle="tooltip" data-placement="right" title="Borrar">
                                                    <i class="icon-trash"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane p-l-0 p-r-0" id="tavLugar" [ngClass]="{'active':fragment == 'tavLugar'}">
                    <h3 class="align-center"><strong>Lugar de desarrollo</strong></h3>
                    <div class="card" *ngIf="lugar_desarrollos.length === 0">
                        <div class="body text-center">
                            <div class="not_found">
                                    <h4 class="m-b-0">Lo sentimos, No se encontraron resultados.</h4>
                            </div>
                        </div>
                    </div>
                    <div class="card product_item_list" *ngIf="lugar_desarrollos.length > 0">
                        <div class="body">
                            <div class="table-responsive">
                                <table class="table table-hover m-b-0">
                                    <thead class="thead-dark align-center">
                                        <tr>
                                            <th>Departamento</th>
                                            <th data-breakpoints="sm xs">Provincia</th>
                                            <th>Municipio</th>
                                            <th data-breakpoints="xs">Localidad o comunidad</th>
                                            <th>Latitud y Logintud <i>Maxima</i></th>
                                            <th>Latitud y Logintud <i>Minima</i></th>
                                            <th data-breakpoints="xs md">Estado</th>
                                            <th data-breakpoints="sm xs md">Acción</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let lugar_desarrollo of lugar_desarrollos">
                                            <td>
                                                <span>{{lugar_desarrollo.departamento}}</span>
                                            </td>
                                            <td>{{lugar_desarrollo.provincia}}</td>
                                            <td>{{lugar_desarrollo.municipio}}</td>
                                            <td>{{lugar_desarrollo.localidad}}</td>
                                            <td>
                                                {{lugar_desarrollo.latmax}} <br>
                                                {{lugar_desarrollo.lonmax}}
                                            </td>
                                            <td>
                                                {{lugar_desarrollo.latmin}} <br>
                                                {{lugar_desarrollo.lonmin}}
                                            </td>
                                            <td>
                                                <span *ngIf="lugar_desarrollo.estado===true"
                                                    class="badge badge-success bg-success text-white">Activo</span>
                                                <span *ngIf="lugar_desarrollo.estado===false"
                                                    class="badge badge-danger bg-danger text-white">Inactivo</span>
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-outline-secondary mr-1" (click)="openModalLugarDesarrollo(content2, 'lg', lugar_desarrollo.id_lugar_desarrollo)" data-toggle="tooltip" data-placement="right" title="Editar">
                                                    <i class="icon-pencil"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary" (click)="openModalEliminar(content9, 'sm', lugar_desarrollo)" data-toggle="tooltip" data-placement="right" title="Borrar">
                                                    <i class="icon-trash"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane p-l-0 p-r-0" id="tavDifusion" [ngClass]="{'active':fragment == 'tavDifusion'}" *ngIf="(difusiones | searchDifusiones: valorBusquedaDifusion) as result">
                    <h3 class="align-center"><strong>Difusión</strong></h3>
                    <div class="row">
                        <div class="col-lg-5 col-md-8 col-sm-12">
                            <form id="navbar-search" class="navbar-form search-form">
                                <input [formControl]="searchDifusion" class="form-control" placeholder="Buscar titulo ..."
                                    type="text" />
                                <button type="button" class="btn btn-default"><i class="icon-magnifier"></i></button>
                            </form>
                        </div>
                        <div ngbDropdown class="d-inline-block col-lg-5 col-md-8 col-sm-12">
                            <button class="btn btn-default mr-1 mb-3" id="dropdownBasic1" ngbDropdownToggle>
                                Listado
                            </button>
                            <div ngbDropdownMenu aria-labelledby="dropdownBasic1" right>
                                <button class="btn btn-default" (click)="obtenerDifusion(5)" ngbDropdownItem> Todos </button>
                                <button class="btn btn-default" (click)="obtenerDifusion(1)" ngbDropdownItem> Cursos, Seminarios y Talleres </button>
                                <button class="btn btn-default" (click)="obtenerDifusion(2)" ngbDropdownItem> Eventos cientificos </button>
                                <button class="btn btn-default" (click)="obtenerDifusion(3)" ngbDropdownItem> Notas de prensa </button>
                                <button class="btn btn-default" (click)="obtenerDifusion(4)" ngbDropdownItem> Exposiciones y conferencias </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card" *ngIf="difusiones.length === 0 || result.length === 0">
                        <div class="body text-center">
                            <div class="not_found">
                                    <h4 class="m-b-0">Lo sentimos, No se encontraron resultados.</h4>
                            </div>
                        </div>
                    </div>
                    <div class="card product_item_list" *ngIf="result.length > 0">
                        <div class="body">
                            <h5 class="align-center"><strong>{{listado_difusion}}</strong></h5>
                            <div class="table-responsive">
                                <table class="table table-hover m-b-0">
                                    <thead class="thead-dark align-center">
                                        <tr>
                                            <th>Titulo</th>
                                            <th data-breakpoints="sm xs">Objetivo</th>
                                            <th>Lugar de realización</th>
                                            <th data-breakpoints="xs">Fecha</th>
                                            <th data-breakpoints="xs md">Archivos</th>
                                            <th data-breakpoints="xs md">Estado</th>
                                            <th data-breakpoints="sm xs md">Acción</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let difusion of result">
                                            <td>{{difusion.titulo}}</td>
                                            <td>{{difusion.objetivo}}</td>
                                            <td>{{difusion.lugar}}</td>
                                            <td>
                                                <span *ngIf="difusion.fecha">{{difusion.fecha | date:'yyyy-MM-dd'}}</span>
                                                <span *ngIf="!difusion.fecha">{{difusion.fechaini | date:'yyyy-MM-dd'}} a
                                                    {{difusion.fechafin | date:'yyyy-MM-dd'}}</span>
                                            </td>
                                            <td>
                                                <div *ngFor="let archivoB of difusion.archivos">
                                                    <a *ngIf="archivoB.id_curso_archivo" type="button" target="_blank" href="{{who + 'cursos/' +archivoB.archivo}}"><i class="fa fa-file text-info"></i></a> 
                                                    <a *ngIf="archivoB.id_evento_archivo" type="button" target="_blank" href="{{who + 'eventos/' +archivoB.archivo}}"><i class="fa fa-file text-info"></i></a> 
                                                    <a *ngIf="archivoB.id_nota_archivo" type="button" target="_blank" href="{{who + 'notas_prensa/' +archivoB.archivo}}"><i class="fa fa-file text-info"></i></a> 
                                                    <a *ngIf="archivoB.id_expo_archivo" type="button" target="_blank" href="{{who + 'exposiciones/' +archivoB.archivo}}"><i class="fa fa-file text-info"></i></a> 
                                                    &nbsp;
                                                    <small class="title"><a type="button" class="text-primary" (click)="openModalArchivo(content5, 'lg', archivoB)">{{archivoB.nombre}}</a></small>
                                                    <!-- <small><a (click)="openModalArchivo(content5, 'lg', archivoB)"> {{archivoB.nombre}} </a></small> -->
                                                </div>
                                            </td>
                                            <td>
                                                <span *ngIf="difusion.estado===true"
                                                    class="badge badge-success bg-success text-white">Activo</span>
                                                <span *ngIf="difusion.estado===false"
                                                    class="badge badge-danger bg-danger text-white">Inactivo</span>
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-outline-secondary mr-1" (click)="openModalDifusion(content3, 'lg', difusion)" data-toggle="tooltip" data-placement="right" title="Editar">
                                                    <i class="icon-pencil"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary" (click)="openModalEliminar(content9, 'sm', difusion)" data-toggle="tooltip" data-placement="right" title="Borrar">
                                                    <i class="icon-trash"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane p-l-0 p-r-0" [ngClass]="{'active':fragment == 'tavSeguimiento'}">
                    <h3 class="align-center"><strong>Tabla de Seguimiento</strong></h3>
                    <div class="card product_item_list">
                        <div class="body">
                            <div class="table-responsive">
                                <table class="table table-hover table-bordered m-b-0">
                                    <thead class="thead-dark align-center">
                                        <tr>
                                            <th scope="col">INICIO</th>
                                            <th scope="col">EJECUCIÓN</th>
                                            <th scope="col">FINALIZACIÓN</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="colores">
                                            <td>
                                                <p *ngIf="inicioSegui.length === 0" class="text-danger"><small>Lo siento, No tiene seguimientos de inicio de proyecto.</small></p>
                                                <ul class="list-group mb-2" *ngFor="let seguimiento of inicioSegui" >
                                                    <li class="list-group-item list-group-item-success">{{seguimiento.revision}}</li>
                                                    <li class="list-group-item list-group-item-warning">{{seguimiento.observaciones}}</li>
                                                    <li class="list-group-item list-group-item-primary" *ngFor="let archivo of seguimiento.archivos">
                                                        <a class="text-primary" type="button" target="_blank" href="{{who +'seguimientos/'+ archivo.archivo}}"><i class="fa fa-file-pdf-o"></i> &nbsp;{{archivo.nombre}}.pdf</a>
                                                    </li>
                                                </ul>
                                            </td>
                                            <td>
                                                <p *ngIf="ejecucionSegui.length === 0" class="text-danger"><small>Lo siento, No tiene seguimientos de Ejecución de proyecto.</small></p>
                                                <ul class="list-group mb-2" *ngFor="let seguimiento of ejecucionSegui">
                                                    <li class="list-group-item list-group-item-success">{{seguimiento.revision}}</li>
                                                    <li class="list-group-item list-group-item-warning">{{seguimiento.observaciones}}</li>
                                                    <li class="list-group-item list-group-item-primary" *ngFor="let archivo of seguimiento.archivos">
                                                        <a class="text-primary" type="button" target="_blank" href="{{who +'seguimientos/'+ archivo.archivo}}"><i class="fa fa-file-pdf-o"></i> &nbsp;{{archivo.nombre}}.pdf</a>
                                                    </li>
                                                </ul>
                                            </td>
                                            <td>
                                                <p *ngIf="finalizacionSegui.length === 0" class="text-danger"><small>Lo siento, No tiene seguimientos de Finalización de proyecto.</small></p>
                                                <ul class="list-group mb-2" *ngFor="let seguimiento of finalizacionSegui">
                                                    <li class="list-group-item list-group-item-success">{{seguimiento.revision}}</li>
                                                    <li class="list-group-item list-group-item-warning">{{seguimiento.observaciones}}</li>
                                                    <li class="list-group-item list-group-item-primary" *ngFor="let archivo of seguimiento.archivos">
                                                        <a class="text-primary" type="button" target="_blank" href="{{who +'seguimientos/'+ archivo.archivo}}"><i class="fa fa-file-pdf-o"></i> &nbsp;{{archivo.nombre}}.pdf</a>
                                                    </li>
                                                </ul>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <h3 class="align-center">Lista de Seguimientos</h3>
                    <div class="card" *ngIf="seguimientos.length === 0">
                        <div class="body text-center">
                            <div class="not_found">
                                    <h4 class="m-b-0">Lo sentimos, No se encontraron resultados.</h4>
                            </div>
                        </div>
                    </div>
                    <div class="card product_item_list" *ngIf="seguimientos.length > 0">
                        <div class="body">
                            <div class="table-responsive">
                                <table class="table table-hover m-b-0 ">
                                    <thead class="thead-dark align-center">
                                        <tr>
                                            <th data-breakpoints="xs">Tipo de seguimiento</th>
                                            <th>Revision</th>
                                            <th>Observaciones</th>
                                            <th data-breakpoints="md">Archivos</th>
                                            <th data-breakpoints="xs md">Estado</th>
                                            <th data-breakpoints="sm xs md">Acción</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let seguimiento of seguimientos">
                                            <td>{{seguimiento.tipo}}</td>
                                            <td>{{seguimiento.revision}}</td>
                                            <td>
                                                {{seguimiento.observaciones}}
                                            </td>
                                            <td>
                                                <div *ngFor="let archivoB of seguimiento.archivos">
                                                    <a type="button" target="_blank" href="{{who + 'seguimientos/' +archivoB.archivo}}">
                                                        <i class="fa fa-file text-info"></i>
                                                    </a> &nbsp;
                                                    <small class="title"><a type="button" class="text-primary" (click)="openModalArchivo(content5, 'lg', archivoB)">{{archivoB.nombre}}</a></small>
                                                    <!-- <small><a (click)="openModalArchivo(content5, 'lg', archivoB)"> {{archivoB.nombre}} </a></small> -->
                                                </div>
                                            </td>
                                            <td>
                                                <span *ngIf="seguimiento.estado===true"
                                                    class="badge badge-success bg-success text-white">True</span>
                                                <span *ngIf="seguimiento.estado===false"
                                                    class="badge badge-danger bg-danger text-white">False</span>
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-outline-secondary mr-1" (click)="openModalNuevoSeguimiento(content7, 'lg', seguimiento.id_seguimiento)" data-toggle="tooltip" data-placement="right" title="Ver">
                                                    <i class="icon-eye"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane p-l-0 p-r-0" [ngClass]="{'active':fragment == 'tavPeticion'}">
                    <h3 class="align-center">Peticiones</h3>
                    <div class="card" *ngIf="peticiones.length === 0">
                        <div class="body text-center">
                            <div class="not_found">
                                    <h4 class="m-b-0">Lo sentimos, No se encontraron resultados.</h4>
                            </div>
                        </div>
                    </div>
                    <div class="card product_item_list" *ngIf="peticiones.length > 0">
                        <div class="body">
                            <div class="table-responsive">
                                <table class="table table-hover m-b-0">
                                    <thead class="thead-dark align-center">
                                        <tr>
                                            <th>Investigador</th>
                                            <th data-breakpoints="xs">Tipo de petición</th>
                                            <th>Motivos</th>
                                            <th>Detalles</th>
                                            <th data-breakpoints="md">Archivos</th>
                                            <th data-breakpoints="xs md">Estado</th>
                                            <th data-breakpoints="sm xs md">Acción</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let peticion of peticiones">
                                            <td>{{peticion.investigador}}</td>
                                            <td>{{peticion.tipo}}</td>
                                            <td>{{peticion.motivos}}</td>
                                            <td>
                                                {{peticion.detalle}}
                                            </td>
                                            <td>
                                                <div *ngFor="let archivoB of peticion.archivos">
                                                    <a type="button" target="_blank" href="{{who +'peticiones/'+ archivoB.archivo}}">
                                                        <i class="fa fa-file text-info"></i>
                                                    </a> &nbsp;
                                                    <small class="title"><a type="button" class="text-primary" (click)="openModalArchivo(content5,'lg', archivoB)">{{archivoB.nombre}}</a></small>
                                                </div>
                                            </td>
                                            <td>
                                                <span *ngIf="peticion.estado===true"
                                                    class="badge badge-success bg-success text-white">Activo</span>
                                                <span *ngIf="peticion.estado===false"
                                                    class="badge badge-danger bg-danger text-white">Inactivo</span>
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-outline-secondary mr-1" (click)="openModalPeticion(content8, 'lg', peticion.id_peticion)" data-toggle="tooltip" data-placement="right" title="Ver">
                                                    <i class="icon-eye"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<!-- *************************************** MODAL BASICA TECNICA *************************************** -->
<ng-template #content1 let-modal>
    <div class="modal-header">
        <h4 class="modal-title">Información proyecto</h4>
    </div>
    <div class="modal-body">
        <form class="container" #formBasicaTecnica="ngForm" (ngSubmit)="guardarBasicaTecnica()">
            <h5 class="align-center">Basica General</h5>
            <div class="form-group row">
                <label class="col-12 col-md-3" for="carrera_inv">Carrera: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="basica_tecnica.carrera" class="form-control" name="carrera" #carrera="ngModel" placeholder="Carrera ..." />
                </div>
                <label class="col-12 col-md-3" for="n_instituto">Nombre Instituto: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="basica_tecnica.n_instituto" class="form-control" name="n_instituto" #n_instituto="ngModel" placeholder="Nombre Instituto ..." />
                </div>
                <label class="col-12 col-md-3" for="objetivo">Objetivo: </label>
                <div class="col-12 col-md-9 mb-1">
                    <textarea [(ngModel)]="basica_tecnica.objetivo" rows="2" cols="30" class="form-control" name="objetivo"
                        #objetivo="ngModel" placeholder="objetivo del proyecto de investigación">
                    </textarea>
                </div>
                <label class="col-12 col-md-3" for="resumen">Resumen: </label>
                <div class="col-12 col-md-9 mb-1">
                    <textarea [(ngModel)]="basica_tecnica.resumen" rows="3" cols="30" class="form-control" name="resumen"
                        #resumen="ngModel" placeholder="resumen del proyecto de investigación">
                    </textarea>
                </div>
            </div>
            <hr>
            <h5 class="align-center">Basica Tecnica</h5>
            <div class="form-group row">
                <label class="col-12 col-md-3" for="tipo_investigacion">Tipo de investigación: </label>
                <div class="col-12 col-md-9 mb-1">
                    <select [(ngModel)]="basica_tecnica.tipo" class="form-control" name="tipo" #tipo="ngModel">
                        <option value=null> --Seleccionar-- </option>
                        <option value="basica">Basica</option>
                        <option value="aplicada">Aplicada</option>
                        <option value="experimental">Experimental</option>
                        <option value="aplicacion">Aplicacion</option>
                        <option value="Otro">Otros</option>
                    </select>
                </div>
                <label class="col-12 col-md-3" for="area_investigacion">Linea o Area de investigación: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="basica_tecnica.area" class="form-control" name="area" #area="ngModel" placeholder="Area de investigacion ..." />
                </div>
                <label class="col-12 col-md-3" for="tipo_proyecto">Tipo de Proyecto: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="basica_tecnica.tipo_p" class="form-control" name="tipo_p" #tipo_p="ngModel" placeholder="Tipo de proyecto ..." />
                </div>
                <label class="col-12 col-md-3" for="carga_h">Carga horaria dedicada al proyecto: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="basica_tecnica.carga_h" class="form-control" name="carga_h" #carga_h="ngModel" type="number" placeholder="0" />
                </div>
                <div class="col-12 col-md-3">
                    <label for="unidad">Unidades involucradas: </label>
                    <button type="button" class="btn btn-outline-primary mb-1" (click)="addUnidad()">Agregar Unidad</button>
                </div>
                <div class="col-12 col-md-9">
                    <section *ngFor="let unidad of unidades; let i = index">
                        <div class="input-group mb-1">
                            <input [(ngModel)]="unidad.nombre" class="form-control" name="uni{{i}}" #uni="ngModel" type="text"
                            [ngClass]="{'parsley-error':!uni.valid && (uni.touched || formBasicaTecnica.submitted)}" placeholder="Unidad {{i+1}}"
                            required />
                            <input type="text" [(ngModel)]="unidad.observacion" class="form-control" name="obse{{i}}" #obse="ngModel" placeholder="Observacion {{i+1}}">
                            <div class="input-group-append">
                                <button type="button" class="btn btn-outline-secondary" (click)="removeUnidad(i)"><i class="icon-trash"></i></button>
                            </div>
                        </div>
                        <ul class="parsley-errors-list filled" *ngIf="!uni.valid && (uni.touched || formBasicaTecnica.submitted)">
                            <li class="parsley-required" *ngIf="uni.hasError('required')">Unidad {{i+1}} de la UMSA Co-Ejecutante requerida</li>
                        </ul>
                    </section>
                </div>
            </div>
            <hr>
            <h5 class="align-center">Financiamiento</h5>
            <div class="form-group row">
                <label class="col-12 col-md-3" for="financia">Financiamiento: </label>
                <div class="col-12 col-md-9">
                    <div class="input-group mb-1">
                        <input [(ngModel)]="basica_tecnica.financiamiento" class="form-control" name="financiamiento" #financiamiento="ngModel" type="number" placeholder="0"/>
                        <div class="input-group-append">
                            <select [(ngModel)]="basica_tecnica.moneda" class="form-control" name="moneda" #moneda="ngModel">
                                <option value=null> --Moneda-- </option>
                                <option value="Bs.">Bs.</option>
                                <option value="USD">USD</option>
                                <option value="EURO">EUROS</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3">
                    <label for="financiamiento">Fuentes Financiamiento: </label>
                    <button type="button" class="btn btn-outline-primary mb-1" (click)="addFinanciamiento()"><small>Agregar Financiamiento</small></button>
                </div>
                <div class="col-12 col-md-9 mb-1">
                    <section *ngFor="let financiamiento of financiamientos; let i = index">
                        <div class="input-group mb-1">
                            <input [(ngModel)]="financiamiento.fuente" class="form-control" name="fuente{{i}}" #fuente="ngModel" type="text"
                            [ngClass]="{'parsley-error':!fuente.valid && (fuente.touched || formBasicaTecnica.submitted)}" placeholder="Financiamiento {{i+1}}"
                            required />
                            <input type="number" [(ngModel)]="financiamiento.aporte" class="form-control" name="aporte{{i}}" #aporte="ngModel" 
                            [ngClass]="{'parsley-error':!aporte.valid && (aporte.touched || formBasicaTecnica.submitted)}" placeholder="Aporte {{i+1}}" required>
                            <input type="text" [(ngModel)]="financiamiento.observacion" class="form-control" name="observacion{{i}}" #observacion="ngModel" placeholder="Observacion {{i+1}}">
                            <div class="input-group-append">
                                <button type="button" class="btn btn-outline-secondary" (click)="removeFinanciamiento(i)"><i class="icon-trash"></i></button>
                            </div>
                        </div>
                        <ul class="parsley-errors-list filled" *ngIf="!fuente.valid && (fuente.touched || formBasicaTecnica.submitted)">
                            <li class="parsley-required" *ngIf="fuente.hasError('required')">Financiamiento {{i+1}} requerido</li>
                        </ul>
                    </section>
                </div>
            </div>
            <button class="btn btn-success" [disabled]="!formBasicaTecnica.form.valid" type="submit">
                Guardar Cambios
            </button>
            <button class="btn btn-danger" (click)="modal.dismiss('Close click')" type="button">
                Cancelar
            </button>
        </form>
    </div>
</ng-template>

<!-- *************************************** MODAL LUGAR DE DESARROLLO *************************************** -->
<ng-template #content2 let-modal>
    <div class="modal-header">
        <h4 class="modal-title">Lugar de desarrollo</h4>
    </div>
    <div class="modal-body">
        <form class="container" #formLugarDesarrollo="ngForm" (ngSubmit)="guardarLugarDesarrollo()">
            <div class="form-group row">
                <label class="col-12 col-md-3" for="departamento">Departamento: </label>
                <div class="col-12 col-md-9 mb-1">
                    <select [(ngModel)]="lugar_desarrollo.departamento" class="form-control" name="departamento"
                        #departamento="ngModel"
                        [ngClass]="{'parsley-error':!departamento.valid && (departamento.touched || formLugarDesarrollo.submitted)}"
                        (ngModelChange)="obtenerProvincias()" required>
                        <option value="">-- Seleccionar departamento --</option>
                        <option *ngFor="let departamento of departamentos" [value]="departamento.value">
                            {{departamento.depa}}</option>
                    </select>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!departamento.valid && (departamento.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="departamento.hasError('required')">Departamento requerida.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" for="provincia">Provincia: </label>
                <div class="col-12 col-md-9 mb-1">
                    <select [(ngModel)]="lugar_desarrollo.provincia" class="form-control" name="provincia"
                        #provincia="ngModel"
                        [ngClass]="{'parsley-error':!provincia.valid && (provincia.touched || formLugarDesarrollo.submitted)}"
                        required>
                        <option value="">-- Seleccionar provincia --</option>
                        <option *ngFor="let provincia of provincias" value="{{provincia.provi}}">{{provincia.provi}}
                        </option>
                    </select>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!provincia.valid && (provincia.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="provincia.hasError('required')">provincia requerida.</li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" for="municipio">Municipio: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="lugar_desarrollo.municipio" class="form-control" name="municipio"
                        #municipio="ngModel"
                        [ngClass]="{'parsley-error':!municipio.valid && (municipio.touched || formLugarDesarrollo.submitted)}" placeholder="Municipio ..."
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!municipio.valid && (municipio.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="municipio.hasError('required')">
                            Municipio requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" for="localidad">Localidad o comunidad: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="lugar_desarrollo.localidad" class="form-control" name="localidad"
                        #localidad="ngModel"
                        [ngClass]="{'parsley-error':!localidad.valid && (localidad.touched || formLugarDesarrollo.submitted)}" placeholder="Localidad o comunidad ..."
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!localidad.valid && (localidad.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="localidad.hasError('required')">
                            localidad o comunidad requerido.
                        </li>
                    </ul>
                </div>
            </div>
            <hr>
            <h5 class="align-center">Georreferenciación</h5>
            <div class="form-group row">
                <label class="col-12 col-md-2" for="latitud maxima">Latitud maxima: </label>
                <div class="col-12 col-md-4 mb-1">
                    <input [(ngModel)]="lugar_desarrollo.latmax" class="form-control" name="latmax" #latmax="ngModel"
                        [ngClass]="{'parsley-error':!latmax.valid && (latmax.touched || formLugarDesarrollo.submitted)}" placeholder="1.00000"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!latmax.valid && (latmax.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="latmax.hasError('required')">
                            Latitud maxima requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-2" for="longitud maxima">Longitud maxima: </label>
                <div class="col-12 col-md-4 mb-1">
                    <input [(ngModel)]="lugar_desarrollo.lonmax" class="form-control" name="lonmax" #lonmax="ngModel"
                        [ngClass]="{'parsley-error':!lonmax.valid && (lonmax.touched || formLugarDesarrollo.submitted)}" placeholder="-1.00000"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!lonmax.valid && (lonmax.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="lonmax.hasError('required')">
                            Longitud maxima requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-2" for="latitud minima">Latitud minima: </label>
                <div class="col-12 col-md-4 mb-1">
                    <input [(ngModel)]="lugar_desarrollo.latmin" class="form-control" name="latmin" #latmin="ngModel"
                        [ngClass]="{'parsley-error':!latmin.valid && (latmin.touched || formLugarDesarrollo.submitted)}" placeholder="180.00000"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!latmin.valid && (latmin.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="latmin.hasError('required')">
                            Latitud minima requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-2" for="longitud minima">Longitud minima: </label>
                <div class="col-12 col-md-4 mb-1">
                    <input [(ngModel)]="lugar_desarrollo.lonmin" class="form-control" name="lonmin" #lonmin="ngModel"
                        [ngClass]="{'parsley-error':!lonmin.valid && (lonmin.touched || formLugarDesarrollo.submitted)}" placeholder="-180.00000"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!lonmin.valid && (lonmin.touched || formLugarDesarrollo.submitted)">
                        <li class="parsley-required" *ngIf="lonmin.hasError('required')">
                            Longitud minima requerido.
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <agm-map 
                    [latitude]="lat"
                    [longitude]="lng"
                    [zoom]="zoom"
                    [disableDefaultUI]="false"
                    (mapClick)="mapClicked($event)">

                    <agm-marker 
                        *ngFor="let m of markers; let i = index"
                        (markerClick)="clickedMarker(m.label, i)"
                        [latitude]="m.lat"
                        [longitude]="m.lng"
                        [label]="m.label"
                        [markerDraggable]="m.draggable"
                        (dragEnd)="markerDragEnd(m, $event)">
                        
                        <agm-info-window>
                        <strong>InfoWindow content</strong>
                        </agm-info-window>
                        
                    </agm-marker>
                    
                    <agm-circle [latitude]="lat + 0.3" [longitude]="lng" 
                        [radius]="5000"
                        [fillColor]="'red'"
                        [circleDraggable]="true"
                        [editable]="true">
                    </agm-circle>

                </agm-map>
            </div>
            <div class="form-group">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="estado" name="estado"
                        [(ngModel)]="lugar_desarrollo.estado" />
                    <label class="form-check-label" for="estado">Estado</label>
                </div>
            </div>
            <button class="btn btn-success" [disabled]="!formLugarDesarrollo.form.valid" type="submit">
                Guardar Cambios
            </button>
            <button class="btn btn-danger" (click)="modal.dismiss('Close click')" type="button">
                Cancelar
            </button>
        </form>
    </div>
</ng-template>
<!-- ************************************* MODAL DIFUSION ************************************* -->
<ng-template #content3 let-modal>
    <div class="modal-header">
        <h4 class="modal-title">{{ tituloFormulario }}</h4>
    </div>
    <div class="modal-body">
        <form class="container" #formDifusion="ngForm" (ngSubmit)="guardarDifusion()">
            <div class="form-group row">
                <label class="col-12 col-md-3">Titulo: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="difusion.titulo" class="form-control" name="titulo" #titulo="ngModel" placeholder="Titulo ..."
                        [ngClass]="{'parsley-error':!titulo.valid && (titulo.touched || formDifusion.submitted)}"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!titulo.valid && (titulo.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="titulo.hasError('required')">
                            Titulo del Curso, Seminario o Taller requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" *ngIf="tipoDifusion===4">Tema a presentar: </label>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion===4">
                    <input [(ngModel)]="difusion.tema" class="form-control" name="tema" #tema="ngModel"
                        [ngClass]="{'parsley-error':!tema.valid && (tema.touched || formDifusion.submitted)}" placeholder="Tema a presentar ..."
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!tema.valid && (tema.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="tema.hasError('required')">
                            Tema a presentar requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3">Objetivo: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="difusion.objetivo" class="form-control" name="objetivo" #objetivo="ngModel" placeholder="Obtetivo ..."
                        [ngClass]="{'parsley-error':!objetivo.valid && (objetivo.touched || formDifusion.submitted)}"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!objetivo.valid && (objetivo.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="objetivo.hasError('required')">
                            Objetivo del Curso, Seminario o Taller requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3">Lugar de realización: </label>
                <div class="col-12 col-md-9 mb-1">
                    <input [(ngModel)]="difusion.lugar" class="form-control" name="lugar" #lugar="ngModel" placeholder="Lugar de realización ..."
                        [ngClass]="{'parsley-error':!lugar.valid && (lugar.touched || formDifusion.submitted)}"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!lugar.valid && (lugar.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="lugar.hasError('required')">
                            lugar del Curso, Seminario o Taller requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" *ngIf="tipoDifusion===3">Prensa: </label>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion===3">
                    <input [(ngModel)]="difusion.prensa" class="form-control" name="prensa" #prensa="ngModel" placeholder="Prensa ..."
                        [ngClass]="{'parsley-error':!prensa.valid && (prensa.touched || formDifusion.submitted)}"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="!prensa.valid && (prensa.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="prensa.hasError('required')">
                            Prensa requerido.
                        </li>
                    </ul>
                </div>
                <div class="col-12 col-md-3 mb-1" *ngIf="tipoDifusion==1">
                    <label>Nombres de los expositores: </label>
                    <button type="button" class="btn btn-outline-primary mb-1" (click)="addExpositor()">Agregar
                        Expositor</button>
                </div>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion==1">
                    <section *ngFor="let expositor of expositores; let i = index">
                        <div class="input-group mb-1">
                            <input [(ngModel)]="expositor.nombres" class="form-control" name="expo{{i}}" #expo="ngModel" type="text"
                            [ngClass]="{'parsley-error':!expo.valid && (expo.touched || formDifusion.submitted)}" placeholder="Nombre completo expositor {{i+1}}"
                            required />
                            <div class="input-group-append">
                                <button type="button" class="btn btn-outline-secondary" (click)="removeExpositor(i)"><i class="icon-trash"></i></button>
                            </div>
                        </div>
                        <ul class="parsley-errors-list filled" *ngIf="!expo.valid && (expo.touched || formDifusion.submitted)">
                            <li class="parsley-required" *ngIf="expo.hasError('required')">Nombre del expositor {{i+1}}</li>
                        </ul>
                    </section>
                </div>
                <label class="col-12 col-md-3" *ngIf="tipoDifusion===1 || tipoDifusion===4">Numero de asistentes: </label>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion===1 || tipoDifusion===4">
                    <input type="number" [(ngModel)]="difusion.asistentes" class="form-control" name="asistentes"
                        #asistentes="ngModel" placeholder="0"
                        [ngClass]="{'parsley-error':(!asistentes.valid || !(difusion && difusion.asistentes && difusion.asistentes >= 5)) && (asistentes.touched || formDifusion.submitted)}"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="(!asistentes.valid || !(difusion && difusion.asistentes && difusion.asistentes >= 5)) && (asistentes.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="asistentes.hasError('required')">Numero de asistentes
                            requerido</li>
                        <li class="parsley-required"
                            *ngIf="!asistentes.hasError('required') && !(difusion && difusion.asistentes && difusion.asistentes >= 5)">
                            El numero de asistentes debe ser mayor a 5</li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" *ngIf="tipoDifusion===3">Fecha: </label>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion===3">
                    <div class="input-group">
                        <input [(ngModel)]="difusion.fecha" class="form-control" placeholder="yyyy-mm-dd"
                            name="fechaNota" #fechaNota="ngModel" ngbDatepicker #dp="ngbDatepicker"
                            [ngClass]="{'parsley-error':!fechaNota.valid && (fechaNota.touched || formDifusion.submitted)}"
                            required>
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary input-group-text" href="javascript:void(0);"
                                (click)="dp.toggle()" type="button"><i class="icon-calendar"></i></button>
                        </div>
                    </div>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!fechaNota.valid && (fechaNota.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="fechaNota.hasError('required')">Fecha
                            requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" *ngIf="tipoDifusion!==3">Fecha Inicio: </label>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion!==3">
                    <div class="input-group">
                        <input [(ngModel)]="fechainicio" class="form-control" placeholder="yyyy-mm-dd" name="fechaini"
                            #fechaini="ngModel" ngbDatepicker #dp1="ngbDatepicker"
                            [ngClass]="{'parsley-error':!fechaini.valid && (fechaini.touched || formDifusion.submitted)}"
                            required>
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary input-group-text" href="javascript:void(0);"
                                (click)="dp1.toggle()" type="button"><i class="icon-calendar"></i></button>
                        </div>
                    </div>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!fechaini.valid && (fechaini.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="fechaini.hasError('required')">Fecha de inicio del curso
                            requerido.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" *ngIf="tipoDifusion!==3">Fecha Fin: </label>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion!==3">
                    <div class="input-group">
                        <input [(ngModel)]="fechafinal" class="form-control" placeholder="yyyy-mm-dd" name="fechafin"
                            #fechafin="ngModel" ngbDatepicker #dp2="ngbDatepicker"
                            [ngClass]="{'parsley-error':!fechafin.valid && (fechafin.touched || formDifusion.submitted)}"
                            required>
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary input-group-text" href="javascript:void(0);"
                                (click)="dp2.toggle()" type="button"><i class="icon-calendar"></i></button>
                        </div>
                    </div>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!fechafin.valid && (fechafin.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="fechafin.hasError('required')">Fecha de Fin del curso.
                        </li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" *ngIf="tipoDifusion===1">Horas de participación y/o de aprobación: </label>
                <div class="col-12 col-md-9 mb-1" *ngIf="tipoDifusion===1">
                    <input type="number" [(ngModel)]="difusion.horas" class="form-control" name="horas" #horas="ngModel" placeholder="0"
                        [ngClass]="{'parsley-error':(!horas.valid || !(difusion && difusion.horas && difusion.horas >= 5)) && (horas.touched || formDifusion.submitted)}"
                        required />
                    <ul class="parsley-errors-list filled"
                        *ngIf="(!horas.valid || !(difusion && difusion.horas && difusion.horas >= 5)) && (horas.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="horas.hasError('required')">Numero de horas requerido</li>
                        <li class="parsley-required"
                            *ngIf="!horas.hasError('required') && !(difusion && difusion.horas && difusion.horas >= 5)">
                            El numero de horas debe ser mayor a 5</li>
                    </ul>
                </div>
                <label class="col-12 col-md-3" for="resumen">Resumen: </label>
                <div class="col-12 col-md-9 mb-1">
                    <textarea [(ngModel)]="difusion.resumen" rows="3" cols="30" class="form-control" name="resumen" placeholder="Resumen ..."
                        #resumen="ngModel" [ngClass]="{'parsley-error':!resumen.valid &&(resumen.touched || formDifusion.submitted)}"
                        required></textarea>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!resumen.valid && (resumen.touched || formDifusion.submitted)">
                        <li class="parsley-required" *ngIf="resumen.hasError('required')">
                            Resumen requerido requerido.
                        </li>
                    </ul>
                </div>
            </div>
            <ngfFormData [files]="files" postName="file" [(FormData)]="sendableFormData"></ngfFormData>
            <ngfUploadStatus [(percent)]="progress" [httpEvent]="httpEvent"></ngfUploadStatus>
            <div>
                <div>
                    <div class="my-drop-zone" ngfDrop multiple="1" selectable="1" [(validDrag)]="validComboDrag"
                        [(files)]="files" accept="application/pdf" [maxSize]="maxSize" [(lastInvalids)]="lastInvalids"
                        [(dragFiles)]="dragFiles" [class.invalid-drag]="validComboDrag===false"
                        [class.valid-drag]="validComboDrag" (filesChange)="fileChange(files)"
                        [fileDropDisabled]="fileDropDisabled">
                        <span class="pt-3">
                            Zona para subir archivos<br> <strong>Arrastre/Click</strong><br>
                        </span>
                    </div>
                </div>
            </div>
            <h6 class="py-2">{{ files.length }} Archivos en la cola</h6>
            <div class="table-responsive">
                <table class="table table-hover m-b-0">
                    <thead class="thead-dark">
                        <tr>
                            <th>Nombre</th>
                            <th data-breakpoints="md lg">Descripción</th>
                            <th data-breakpoints="sm xs md">Tamaño</th>
                            <th data-breakpoints="sm xs">Accion</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of files;let i=index">
                            <td nowrap>
                                <div *ngIf="['application/pdf'].indexOf(item.type)>=0">
                                    <div class="previewIcon" [ngfBackground]="item"></div>
                                </div>
                                <div class="form-group">
                                    <strong class="ml-2"
                                        style="font-size: 12px;">{{ item.name.length>35?(item.name | slice:0:35)+'...':(item.name) }}</strong>
                                    <input [(ngModel)]="datosArchivo[i].nombre" class="form-control" name="name{{i}}"
                                        #name="ngModel" placeholder="nombre del documento.."
                                        [ngClass]="{'parsley-error':!name.valid && (name.touched || formDifusion.submitted)}"
                                        required>
                                    <ul class="parsley-errors-list filled"
                                        *ngIf="!name.valid && (name.touched || formDifusion.submitted)">
                                        <li class="parsley-required" *ngIf="name.hasError('required')">
                                            Nombre {{i}} del archivo requerido.
                                        </li>
                                    </ul>
                                </div>
                            </td>
                            <td nowrap>
                                <div class="form-group">
                                    <textarea class="form-control" rows="2" cols="25"
                                        [(ngModel)]="datosArchivo[i].descripcion" name="descripcion{{i}}"
                                        #descripcion="ngModel" required
                                        [ngClass]="{'parsley-error':!descripcion.valid && (descripcion.touched || formDifusion.submitted)}"
                                        placeholder="descripcion del documento.."></textarea>
                                    <ul class="parsley-errors-list filled"
                                        *ngIf="!descripcion.valid && (descripcion.touched || formDifusion.submitted)">
                                        <li class="parsley-required" *ngIf="descripcion.hasError('required')">
                                            Descripcion {{i}} requerida.</li>
                                    </ul>
                                </div>
                            </td>
                            <td nowrap>
                                {{ item.size/1024/1024 | number:'.2' }} MB
                            </td>
                            <td nowrap>
                                <button type="button" class="btn btn-danger btn-xs"
                                    (click)="datosArchivo.splice(i,1) && files.splice(i,1) && antFileTam=antFileTam-1">
                                    <i class="icon-trash"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div>
                <div> Proceso de la cola:
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': progress + '%' }">
                        </div>
                    </div>
                </div>

                <ng-container *ngIf="lastFileAt">
                    <p>
                        <strong>Ultimo documento(s) seleccionado:</strong> {{ lastFileAt | date : 'longTime' }}
                    </p>
                </ng-container>

                <ng-container *ngIf="progress==100">
                    <i class="glyphicon glyphicon-ok"></i>
                    &nbsp;Carga completa
                </ng-container>

                <div class="form-group">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="estado" name="estado"
                            [(ngModel)]="difusion.estado" />
                        <label class="form-check-label" for="estado">Estado</label>
                    </div>
                </div>

                <button type="submit" class="btn btn-success btn-s" [disabled]="!formDifusion.form.valid">
                    <span class="glyphicon glyphicon-upload"></span> Guardar todo
                </button>

                <button type="button" class="btn btn-warning btn-s mx-1" (click)="cancel()"
                    (click)="modal.dismiss('Close click')">
                    <span class="glyphicon glyphicon-ban-circle"></span> Cancelar todo
                </button>
                <button type="button" class="btn btn-danger btn-s" (click)="borrarTodoDifusion()"
                    [disabled]="!files.length">
                    <span class="glyphicon glyphicon-trash"></span> Remover todo
                </button>
            </div>

        </form>
    </div>
</ng-template>
<!-- MODAL agregar publicación -->
<ng-template #content4 let-modal>
    <div class="modal-header">
        <h4 class="modal-title">PUBLICACIÓN</h4>
    </div>
    <div class="modal-body">
        <form class="container" #formPublicacion="ngForm" (ngSubmit)="guardarPublicacion()">
            <section>
                <div class="form-group row">
                    <label class="col-12 col-md-3">Tipo de publicación: </label>
                    <div class="col-12 col-md-9 mb-1">
                        <select [(ngModel)]="publicacion.tipo" class="form-control" name="tipo" #tipo="ngModel"
                            [ngClass]="{'parsley-error':!tipo.valid && (tipo.touched || formPublicacion.submitted)}"
                            required>
                            <option value=""> --Seleccionar el tipo de publicación-- </option>
                            <option value="Artículo">Artículo</option>
                            <option value="Libro">Libro</option>
                            <option value="Capítulo">Capítulo</option>
                            <option value="Codigo">Codigo</option>
                            <option value="Documento de sesión">Documento de sesión</option>
                            <option value="Portada">Portada</option>
                            <option value="Datos">Datos</option>
                            <option value="Hallazgo experimental">Hallazgo experimental</option>
                            <option value="Método">Método</option>
                            <option value="Resultados negativos">Resultados negativos</option>
                            <option value="Patentar">Patentar</option>
                            <option value="Póster">Póster</option>
                            <option value="Preimpresión">Preimpresión</option>
                            <option value="Presentación">Presentación</option>
                            <option value="Datos en bruto">Datos en bruto</option>
                            <option value="Propuesta de investigación">Propuesta de investigación</option>
                            <option value="Reporte técnico">Reporte técnico</option>
                            <option value="Tesis">Tesis</option>
                            <option value="Investigación">Investigación</option>
                            <option value="Propuesta">Propuesta</option>
                        </select>
                        <ul class="parsley-errors-list filled"
                            *ngIf="!tipo.valid && (tipo.touched || formPublicacion.submitted)">
                            <li class="parsley-required" *ngIf="tipo.hasError('required')">Tipo de publicacion
                                requerida.</li>
                        </ul>
                    </div>
                    <label class="col-12 col-md-3">Titulo: </label>
                    <div class="col-12 col-md-9 mb-1">
                        <input [(ngModel)]="publicacion.titulo" class="form-control" name="titulo" #titulo="ngModel" placeholder="Titulo de publicación"
                            [ngClass]="{'parsley-error':!titulo.valid && (titulo.touched || formPublicacion.submitted)}"
                            required />
                        <ul class="parsley-errors-list filled"
                            *ngIf="!titulo.valid && (titulo.touched || formPublicacion.submitted)">
                            <li class="parsley-required" *ngIf="titulo.hasError('required')">
                                Titulo de la publicacion requerida.
                            </li>
                        </ul>
                    </div>
                    <label class="col-12 col-md-3">Autores: </label>
                    <div class="col-12 col-md-9 mb-1">
                        <input [(ngModel)]="publicacion.autores" class="form-control" name="autores" #autores="ngModel" placeholder="Autores de publicación"
                            [ngClass]="{'parsley-error':!autores.valid && (autores.touched || formPublicacion.submitted)}"
                            required />
                        <ul class="parsley-errors-list filled"
                            *ngIf="!autores.valid && (autores.touched || formPublicacion.submitted)">
                            <li class="parsley-required" *ngIf="autores.hasError('required')">
                                Autores de la publicacion requerida.
                            </li>
                        </ul>
                    </div>
                    <label class="col-12 col-md-3" for="tipo">Investigadores enlazados: </label>
                    <div class="col-12 col-md-9 mb-1">
                        <ng-multiselect-dropdown name="multiSelect" #multiSelect="ngModel" [placeholder]="'Seleccionar'"
                            [settings]="dropdownConfiguracion" [data]="dropdownLista" [(ngModel)]="seleccionados"
                            [disabled]="disabled">
                        </ng-multiselect-dropdown>
                        <ul class="parsley-errors-list filled"
                            *ngIf="!multiSelect.valid && (multiSelect.touched || formPublicacion.submitted)">
                            <li class="parsley-required" *ngIf="multiSelect.hasError('required')">Enlazar a algun investigador del sistema.
                            </li>
                        </ul>
                    </div>
                    <!-- <label class="col-12 col-md-3">Fecha: </label>
                    <div class="col-12 col-md-9 mb-1">
                        <div class="input-group">
                            <input [(ngModel)]="publicacion.fecha" class="form-control" placeholder="yyyy-mm-dd"
                                name="fecha" #fecha="ngModel" ngbDatepicker #dp="ngbDatepicker"
                                [ngClass]="{'parsley-error':!fecha.valid && (fecha.touched || formPublicacion.submitted)}"
                                required>
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary input-group-text" href="javascript:void(0);"
                                    (click)="dp.toggle()" type="button"><i class="icon-calendar"></i></button>
                            </div>
                        </div>
                        <ul class="parsley-errors-list filled"
                            *ngIf="!fecha.valid && (fecha.touched || formPublicacion.submitted)">
                            <li class="parsley-required" *ngIf="fecha.hasError('required')">Fecha de publicación
                                requerida.
                            </li>
                        </ul>
                    </div> -->
                    <label class="col-12 col-md-3">Año de publicación: </label>
                    <div class="col-12 col-md-9 mb-1">
                        <input [(ngModel)]="publicacion.fecha" class="form-control" name="fecha" #fecha="ngModel" placeholder="YYYY"
                            [ngClass]="{'parsley-error':!fecha.valid && (fecha.touched || formPublicacion.submitted)}"
                            required />
                        <ul class="parsley-errors-list filled"
                            *ngIf="!fecha.valid && (fecha.touched || formPublicacion.submitted)">
                            <li class="parsley-required" *ngIf="fecha.hasError('required')">
                                Fecha año de la publicacion requerida.
                            </li>
                        </ul>
                    </div>
                    <label class="col-12 col-md-3">Cita bibliografica: </label>
                    <div class="col-12 col-md-9 mb-1">
                        <textarea class="form-control" rows="3" cols="30" [(ngModel)]="publicacion.contenido"
                            name="contenido" #contenido="ngModel" required
                            [ngClass]="{'parsley-error':!contenido.valid && (contenido.touched || formPublicacion.submitted)}" placeholder="Cita bibliografica de publicación..."></textarea>
                        <ul class="parsley-errors-list filled"
                            *ngIf="!contenido.valid && (contenido.touched || formPublicacion.submitted)">
                            <li class="parsley-required" *ngIf="contenido.hasError('required')">Cita bibliografica es
                                requerida.</li>
                        </ul>
                    </div>
                </div>
                
            </section>
            <!-- archivo -->
            <ngfFormData [files]="files" postName="file" [(FormData)]="sendableFormData"></ngfFormData>
            <ngfUploadStatus [(percent)]="progress" [httpEvent]="httpEvent"></ngfUploadStatus>
            <div>
                <div>
                    <div class="my-drop-zone" ngfDrop multiple="1" selectable="1" [(validDrag)]="validComboDrag"
                        [(files)]="files" accept="application/pdf" [maxSize]="maxSize" [(lastInvalids)]="lastInvalids"
                        [(dragFiles)]="dragFiles" [class.invalid-drag]="validComboDrag===false"
                        [class.valid-drag]="validComboDrag" (filesChange)="fileChange(files)"
                        [fileDropDisabled]="fileDropDisabled">
                        <span class="pt-3">
                            Zona para subir archivos<br> <strong>Arrastre/Click</strong><br>
                        </span>
                    </div>
                </div>
            </div>
            <h6 class="py-2">{{ files.length }} Archivos en la cola</h6>
            <div class="table-responsive">
                <table class="table table-hover m-b-0">
                    <thead class="thead-dark">
                        <tr>
                            <th>Nombre</th>
                            <th data-breakpoints="md lg">Descripción</th>
                            <th data-breakpoints="sm xs md">Tamaño</th>
                            <th data-breakpoints="sm xs">Accion</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of files;let i=index">
                            <td nowrap>
                                <div *ngIf="['application/pdf'].indexOf(item.type)>=0">
                                    <div class="previewIcon" [ngfBackground]="item"></div>
                                </div>
                                <div class="form-group">
                                    <strong class="ml-2"
                                        style="font-size: 12px;">{{ item.name.length>35?(item.name | slice:0:35)+'...':(item.name) }}</strong>
                                    <input [(ngModel)]="datosArchivo[i].nombre" class="form-control" name="name{{i}}"
                                        #name="ngModel" placeholder="nombre del documento.."
                                        [ngClass]="{'parsley-error':!name.valid && (name.touched || formPublicacion.submitted)}"
                                        required>
                                    <ul class="parsley-errors-list filled"
                                        *ngIf="!name.valid && (name.touched || formPublicacion.submitted)">
                                        <li class="parsley-required" *ngIf="name.hasError('required')">
                                            Nombre {{i}} del archivo requerido.
                                        </li>
                                    </ul>
                                </div>
                            </td>
                            <td nowrap>
                                <div class="form-group">
                                    <textarea class="form-control" rows="2" cols="25"
                                        [(ngModel)]="datosArchivo[i].descripcion" name="descripcion{{i}}"
                                        #descripcion="ngModel" required
                                        [ngClass]="{'parsley-error':!descripcion.valid && (descripcion.touched || formPublicacion.submitted)}"
                                        placeholder="descripcion del documento.."></textarea>
                                    <ul class="parsley-errors-list filled"
                                        *ngIf="!descripcion.valid && (descripcion.touched || formPublicacion.submitted)">
                                        <li class="parsley-required" *ngIf="descripcion.hasError('required')">
                                            Descripcion {{i}} requerida.</li>
                                    </ul>
                                </div>
                            </td>
                            <td nowrap>
                                {{ item.size/1024/1024 | number:'.2' }} MB
                            </td>
                            <td nowrap>
                                <button type="button" class="btn btn-danger btn-xs"
                                    (click)="datosArchivo.splice(i,1) && files.splice(i,1) && antFileTam=antFileTam-1">
                                    <i class="icon-trash"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div>
                <div> Proceso de la cola:
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': progress + '%' }">
                        </div>
                    </div>
                </div>

                <ng-container *ngIf="lastFileAt">
                    <p>
                        <strong>Ultimo documento(s) seleccionado:</strong> {{ lastFileAt | date : 'longTime' }}
                    </p>
                </ng-container>

                <ng-container *ngIf="progress==100">
                    <i class="glyphicon glyphicon-ok"></i>
                    &nbsp;Carga completa
                </ng-container>

                <div class="form-group">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="estado" name="estado"
                            [(ngModel)]="publicacion.estado" />
                        <label class="form-check-label" for="estado">Estado</label>
                    </div>
                </div>

                <button type="submit" class="btn btn-success btn-s"
                    [disabled]="!formPublicacion.form.valid">
                    <span class="glyphicon glyphicon-upload"></span> Guardar todo
                </button>

                <button type="button" class="btn btn-warning btn-s mx-1" (click)="cancel()"
                    (click)="modal.dismiss('Close click')">
                    <span class="glyphicon glyphicon-ban-circle"></span> Cancelar todo
                </button>
                <button type="button" class="btn btn-danger btn-s" (click)="borrarTodoPublicacion()"
                    [disabled]="!files.length">
                    <span class="glyphicon glyphicon-trash"></span> Remover todo
                </button>
            </div>
        </form>
    </div>
</ng-template>


<!-- MODAL ARCHIVO-->
<ng-template #content5 let-modal>
	<div class="modal-header">
		<h4 class="modal-title">Actualizar archivo</h4>
	</div>
	<div class="modal-body">
		<form class="container" #archivoForm="ngForm" (ngSubmit)="editarArchivo()">
			<div class="form-group row">
				<label class="col-sm-3 col-12" for="tipo">Nombre: </label>
				<div class="col-sm-9 col-12 mb-1">
					<input [(ngModel)]="archivo.nombre" class="form-control" name="nombre" #nombre="ngModel" placeholder="Nombre archivo .."
						[ngClass]="{'parsley-error':!nombre.valid && (nombre.touched || archivoForm.submitted)}"
						required>
					<ul class="parsley-errors-list filled"
						*ngIf="!nombre.valid && (nombre.touched || archivoForm.submitted)">
						<li class="parsley-required" *ngIf="nombre.hasError('required')">Nombre del archivo requerido.
						</li>
					</ul>
				</div>
			</div>
			<div class="form-group row">
				<label class="col-sm-3 col-12" for="tipo">Descripción: </label>
				<div class="col-sm-9 col-12 mb-1">
					<textarea [(ngModel)]="archivo.descripcion" rows="3" cols="30" class="form-control" name="descripcion" #descripcion="ngModel" placeholder="Descripción archivo..."
						[ngClass]="{'parsley-error':!descripcion.valid && (descripcion.touched || archivoForm.submitted)}"
						required></textarea>
					<ul class="parsley-errors-list filled"
						*ngIf="!descripcion.valid && (descripcion.touched || archivoForm.submitted)">
						<li class="parsley-required" *ngIf="descripcion.hasError('required')">Descripcion del archivo requerido.
						</li>
					</ul>
				</div>
			</div>
			<div class="form-group">
				<div class="form-check">
					<input class="form-check-input" type="checkbox" id="estado" name="estado"
						[(ngModel)]="archivo.estado">
					<label class="form-check-label" for="estado">Estado</label>
				</div>
			</div>
			<section *ngIf="!(archivo.id_conv_archivo || archivo.id_contra_archivo || archivo.id_segui_archivo || archivo.id_peti_archivo || archivo.id_proy_archivo || archivo.id_permiso_archivo || archivo.id_convenio || archivo.id_contratado)">
                <button class="btn btn-success" [disabled]="!archivoForm.form.valid" type="submit">Guardar Cambios</button>
                <button class="btn btn-danger" (click)="modal.dismiss('Close click')" type="button">Cancelar</button>
            </section>
            <section *ngIf="archivo.id_conv_archivo || archivo.id_contra_archivo || archivo.id_segui_archivo || archivo.id_peti_archivo || archivo.id_proy_archivo || archivo.id_permiso_archivo || archivo.id_convenio || archivo.id_contratado">
                <button class="btn btn-danger" (click)="modal.dismiss('Close click')" type="button">Salir</button>
            </section>
            
		</form>
	</div>
</ng-template> 

<!-- MODAL Guardar SEGUIMIENTO-->
<ng-template #content7 let-modal>
	<div class="modal-header">
		<h4 class="modal-title">Datos de seguimiento</h4>
	</div>
	<div class="modal-body">
		<form class="container" #seguimientoForm="ngForm">
            <div class="form-group row">
                <label class="col-12 col-md-3">Tipo de seguimiento: </label>
                <div class="col-12 col-md-9">
                    <select [(ngModel)]="seguimiento.tipo" class="form-control" name="tipo" #tipo="ngModel"
                        [ngClass]="{'parsley-error':!tipo.valid && (tipo.touched || seguimientoForm.submitted)}"
                        required>
                        <option value=""> --Seleccionar el tipo de seguimiento-- </option>
                        <option value="Inicio">Inicio</option>
                        <option value="Ejecucion">Ejecucion</option>
                        <option value="Finalizacion">Finalizacion</option>
                    </select>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!tipo.valid && (tipo.touched || seguimientoForm.submitted)">
                        <li class="parsley-required" *ngIf="tipo.hasError('required')">Tipo de seguimiento
                            requerida.</li>
                    </ul>
                </div>
            </div>
			<div class="form-group row">
				<label class="col-sm-3 col-12" for="tipo">Revisión: </label>
				<div class="col-sm-9 col-12">
					<textarea [(ngModel)]="seguimiento.revision" rows="3" cols="30" class="form-control" name="revision" #revision="ngModel" placeholder="Revision ..."
						[ngClass]="{'parsley-error':!revision.valid && (revision.touched || seguimientoForm.submitted)}"
                        required>
                    </textarea>
					<ul class="parsley-errors-list filled"
						*ngIf="!revision.valid && (revision.touched || seguimientoForm.submitted)">
						<li class="parsley-required" *ngIf="revision.hasError('required')">Revision requerido.
						</li>
					</ul>
				</div>
            </div>
            <div class="form-group row">
				<label class="col-sm-3 col-12" for="tipo">Observaciones: </label>
				<div class="col-sm-9 col-12">
					<textarea [(ngModel)]="seguimiento.observaciones" rows="3" cols="30" class="form-control" name="observaciones" #observaciones="ngModel" placeholder="Observaciones ..."
						[ngClass]="{'parsley-error':!observaciones.valid && (observaciones.touched || seguimientoForm.submitted)}"
                        required>
                    </textarea>
					<ul class="parsley-errors-list filled"
						*ngIf="!observaciones.valid && (observaciones.touched || seguimientoForm.submitted)">
						<li class="parsley-required" *ngIf="observaciones.hasError('required')">Observaciones requerido.
						</li>
					</ul>
				</div>
            </div>

			<div class="form-group">
				<div class="form-check">
					<input class="form-check-input" type="checkbox" id="estado" name="estado"
						[(ngModel)]="seguimiento.estado">
					<label class="form-check-label" for="estado">Estado</label>
				</div>
            </div>
			<div class="text-right">
                <button class="btn btn-danger" (click)="modal.dismiss('Close click')" type="button">Salir</button>
            </div>
		</form>
	</div>
</ng-template>

<ng-template #content8 let-modal>
    <div class="modal-header">
        <h4 class="modal-title">Información Peticion</h4>
    </div>
    <div class="modal-body">
        <form class="container" #peticionForm="ngForm">
            
            <div class="form-group row">
                <label class="col-12 col-md-3">Tipo de petición: </label>
                <div class="col-12 col-md-9">
                    <select [(ngModel)]="peticion.tipo" class="form-control" name="tipo" #tipo="ngModel"
                        [ngClass]="{'parsley-error':!tipo.valid && (tipo.touched || peticionForm.submitted)}"
                        required>
                        <option value=""> --Seleccionar el tipo de peticion-- </option>
                        <option value="Manifestaciones">Manifestaciones</option>
                        <option value="Peticiones de información">Peticiones de información</option>
                        <option value="Consultas">Consultas</option>
                    </select>
                    <ul class="parsley-errors-list filled"
                        *ngIf="!tipo.valid && (tipo.touched || peticionForm.submitted)">
                        <li class="parsley-required" *ngIf="tipo.hasError('required')">Tipo de peticion
                            requerida.</li>
                    </ul>
                </div>
            </div>
			<div class="form-group row">
				<label class="col-sm-3 col-12" for="tipo">Motivos: </label>
				<div class="col-sm-9 col-12">
					<textarea [(ngModel)]="peticion.motivos" rows="3" cols="30" class="form-control" name="motivos" #motivos="ngModel" placeholder="Motivos ..."
						[ngClass]="{'parsley-error':!motivos.valid && (motivos.touched || peticionForm.submitted)}"
                        required>
                    </textarea>
					<ul class="parsley-errors-list filled"
						*ngIf="!motivos.valid && (motivos.touched || peticionForm.submitted)">
						<li class="parsley-required" *ngIf="motivos.hasError('required')">Motivos requerido.
						</li>
					</ul>
				</div>
            </div>
            <div class="form-group row">
				<label class="col-sm-3 col-12" for="tipo">Detalles: </label>
				<div class="col-sm-9 col-12">
					<textarea [(ngModel)]="peticion.detalle" rows="3" cols="30" class="form-control" name="detalle" #detalle="ngModel" placeholder="Detalles de la petición ..."
						[ngClass]="{'parsley-error':!detalle.valid && (detalle.touched || peticionForm.submitted)}"
                        required>
                    </textarea>
					<ul class="parsley-errors-list filled"
						*ngIf="!detalle.valid && (detalle.touched || peticionForm.submitted)">
						<li class="parsley-required" *ngIf="detalle.hasError('required')">Detalles requerido.
						</li>
					</ul>
				</div>
            </div>
            <button type="button" class="btn btn-danger btn-s" (click)="cancel()"
                (click)="modal.dismiss('Close click')">
                <span class="glyphicon glyphicon-ban-circle"></span> Salir
            </button>
            
        </form>
    </div>
</ng-template>

<ng-template #content9 let-modal>
    <div class="modal-header">
      <h4 class="modal-title">¿Estas seguro de borrar la {{tituloEliminar}} ?</h4>
    </div>
    <!-- <div class="modal-body">
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin sodales orci ante, sed ornare eros vestibulum ut. Ut accumsan vitae eros sit amet Integer dapibus, mi ac tempor varius, purus nibh mattis erat, vitae porta nunc nisi non tellus. Vivamus mollis ante non massa egestas fringilla. Vestibulum egestas consectetur nunc at ultricies. Morbi quis consectetur nunc.</p>
    </div> -->
    <div class="modal-footer">
      <button type="button" class="btn btn-primary" (click)="eliminar(); modal.close('Ok click')">Si</button>
      <button type="button" class="btn btn-danger" (click)="modal.dismiss('Close click')">No</button>
    </div>
</ng-template>